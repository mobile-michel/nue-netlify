function V(i,C){let u=i.parentNode;if(i==C)return i;if(!i&&C)return u?.appendChild(C);if(!C&&i)return u?.removeChild(i);if(i.nodeType==3&&C.nodeType==3)return i.textContent=C.textContent,i;if(i.nodeType!=C.nodeType||i.tagName!=C.tagName)return u.replaceChild(C,i);d(i,C);let K=Array.from(C.childNodes);return K[0]?.getAttribute?.("key")?c(i,K):_(i,K),i}function d(i,C){for(let u of C.attributes)if(i.getAttribute(u.name)!=u.value)i.setAttribute(u.name,u.value);for(let u of i.attributes)if(!C.hasAttribute(u.name))i.removeAttribute(u.name)}function _(i,C){let u=Array.from(i.childNodes),K=Math.max(u.length,C.length);for(let M=0;M<K;M++){let O=u[M],R=C[M];if(!O)i.appendChild(R);else if(!R)i.removeChild(u[M]);else V(O,R,i)}}function c(i,C){let u=Array.from(i.childNodes),K={};for(let M of u)K[M.getAttribute("key")]=M;while(i.firstChild)i.removeChild(i.firstChild);for(let M of C){let O=M.getAttribute("key"),R=K[O];i.appendChild(R?V(R,M,i):M)}}var W=typeof window=="object";function G(i,C={},u={},K){let{script:M}=i,O;function R(y){if(y)Object.assign(U,y);if(h("onupdate")!==!1){let N=D(i,U).firstChild;if(W||K)V(O,N,O.parentNode);else V(O.firstChild,N,O);h("updated")}}let U={...C,...u.globals,...S(i,C),update:R,parent:K};if(M)try{if(typeof M=="string")Function(M).call(U);else M.call(U)}catch(y){console.error("<script> error:",M,y)}function h(y,N){let A=U[y];if(N?.tagName)O=U.root=N;if(W&&A&&typeof A=="function")return A.call(U,U,R)}function k(y){h("onmount",y);let A=D(i,U).firstChild;if(W?y.replaceWith(A):y.appendChild(A),W)h("mounted",A);return A}U.mount=function(y,N,A){if(typeof N=="string")N=O?.querySelector(N);let P=u.deps?.find((b)=>y==(b.is||b.tag));if(P.is_custom)P.is=P.tag,P.tag="div",delete P.is_custom;G(P,A,u,U).mount(N)};function D(y=i,N=U){return y.text||y.fn?n(y,N):y.some?j(y,N):y.for?m(y,N):y.is_custom?w(y,N):y.tag?F(y,N):E()}function F(y,N){let A=y.svg?document.createElementNS("http://www.w3.org/2000/svg",y.tag):document.createElement(y.tag);if($(A,y,N),K&&y.is_child)$(A,K.ast,K.self);let P=A.classList.length;if(P>(u.max_class_names||3))console.error(`More than ${P} class names in class="${A.classList}"`);let B=A.classList?.toString();if(/[:\[\]]/.test(B))console.error(`Invalid characters in class name: ${B}`);y.handlers?.forEach((z)=>{let I=z.name.slice(2);A.addEventListener(I,function(J){if(I=="submit")J.preventDefault();T(z.h_fn,N,J),R()})}),y.children?.forEach((z,I)=>{if(z.slot){if(u.slot)return A.appendChild(X(u.slot));K?.ast.children?.forEach((J,Y)=>{A.appendChild(D(J,K.self)),H(A,J,K.ast.children[Y+1])})}else A.appendChild(D(z,N));H(A,z,y.children[I+1])});let b=E();return b.appendChild(A),b}function j(y,N){let A=y.some.find((P)=>{let B=P.if||P["else-if"];if(B){let b=T(B,N);return b&&b!="[Error]"}else if(P.else)return!0});if(!A)return E();if(A.tag=="template"){let P=E();return A.children.forEach((B)=>{P.appendChild(D(B,N))}),P}else return D(A,N)}function m(y,N){let A={...y},{keys:P,is_entries:B,index:b,fn:z}=A.for;delete A.for;let I=T(z,N)||[],J=E(),Y=A.tag=="template";return I.forEach((Z,x)=>{let q={...N};if(b)q[b]=x;if(P[1])P.forEach((Q,g)=>q[Q]=Z[B?g:Q]);else q[P[0]]=Z;if(Y)A.children.forEach((Q)=>{J.appendChild(D(Q,q))});else J.appendChild(D(A,q))}),J}function w(y,N){let A=S(y,N),P=u.fns&&u.fns[y.tag];if(P)return X(P({...A,...N},u));let B=o(y,N);if(!B)return X(v(y.tag,A));let b=y.mount&&y.tag!="template"?y.tag:B.is?B.tag:"div",z=G({...B,tag:b,is_custom:!1,is_child:!0},A,u,G(y,N,u,K)),I=z.render();return z.fire("onmount",I.firstChild),z.fire("mounted"),I}function o(y,N){let{mount:A,tag:P}=y;if(A)P=A.fn?T(A.fn,N):A.val;return u.deps?.find((B)=>B!=y&&P==(B.is||B.tag))}return{mount:k,update:R,render:D,ast:i,self:U,fire:h,get root(){return O}}}function n(i,C){let u=i.fn?T(i.fn,C):i.text||"";return i.html?X(u):document.createTextNode(u)}function S(i,C){let u={};return i.attr?.forEach((K)=>{let M=K.fn?T(K.fn,{...C,$concat:L}):K.val;if(K.name=="bind"){if(typeof M=="object")Object.assign(u,M)}else u[K.name]=M}),u}function $(i,C,u){let K=[];if(C.attr?.forEach((M)=>{if(M.is_data)return;let{name:O,val:R,fn:U}=M;if(U)R=T(U,{...u,$concat:L});if(M.is_var)K.push({name:O,val:R});else if(M.bool){if(R)i.setAttribute(O,"")}else if(O=="class")i.classList.add(...R.trim().split(/ +/));else i.setAttribute(O,R)}),K.length)i.setAttribute("style",K.map((M)=>`--${M.name}:${M.val};`).join(""))}function T(i,C,u){try{if(typeof i=="string")i=Function("_","$e","return "+i);let K=i(C,u);if(typeof K=="string")K=K.replaceAll("undefined","");return K==null?"":Number.isNaN(K)?"N/A":K}catch(K){return console.error("Nue error:",K.message),"[Error]"}}function X(i){let C=document.createDocumentFragment();return C.innerHTML=i||"",C}function L(i){return Object.keys(i).map((C)=>i[C]?C:"").filter((C)=>!!C).join(" ")}function E(){return document.createDocumentFragment()}function H(i,C,u){if(C.tag&&u?.tag||C.fn&&u?.fn)i.appendChild(document.createTextNode(" "))}function v(i,C){let u=JSON.stringify(C),K=u!="{}"?`<script type="application/json">${u}</script>`:"";return`<${i} nue="${i}"></${i}>${K}`}function e(i,C){if(i.is_custom)i={...i,is_custom:!1,tag:"div"};let u=G(i,C.data,C);return u.mount(C.root),u}export{e as mount,V as domdiff};
